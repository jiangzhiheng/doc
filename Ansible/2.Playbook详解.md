一、`playbook`示例

1. 定义一个简单的`playbook`

   ```yaml
   # web-notls.yml
   - name: Configure webserver with nginx
     hosts: webservers
     become: True
     tasks:
     - name: Install epel-repo
       shell: wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
   
     - name: Install nginx
       yum: name=nginx state=latest
   
     - name: copy nginx config file
       copy: src=files/nginx.conf dest=/etc/nginx/nginx.conf
   
     - name: copy index.html
       copy: src=template/index.html.j2 dest=/usr/share/nginx/html/index.html
   
     - name: start nginx
       service: name=nginx state=restarted
   ```

2. 定义`nginx`的配置文件

   ```nginx
   # nginx.conf
   user nginx;
   worker_processes auto;
   error_log /var/log/nginx/error.log;
   pid /run/nginx.pid;
   
   # Load dynamic modules. See /usr/share/doc/nginx/README.dynamic.
   include /usr/share/nginx/modules/*.conf;
   
   events {
       worker_connections 1024;
   }
   
   http {
       log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                         '$status $body_bytes_sent "$http_referer" '
                         '"$http_user_agent" "$http_x_forwarded_for"';
   
       access_log  /var/log/nginx/access.log  main;
   
       sendfile            on;
       tcp_nopush          on;
       tcp_nodelay         on;
       keepalive_timeout   65;
       types_hash_max_size 2048;
   
       include             /etc/nginx/mime.types;
       default_type        application/octet-stream;
       include /etc/nginx/conf.d/*.conf;
   
       server {
           listen       80 default_server;
           listen       [::]:80 default_server;
           server_name  _;
           root         /usr/share/nginx/html;
           include /etc/nginx/default.d/*.conf;
   
           location / {
           }
       }
   }
   ```

3. 创建一个定制的首页

   ```html
   <!DOCTYPE html>
   <html lang="en">
   <head>
       <meta charset="UTF-8">
       <title>Welcome to ansible</title>
   </head>
       <body>
           <h1>Nginx, configured by Ansible</h1>
           <p>If you can see this ,Ansible successful installed nginx</p>
       </body>
   </html>
   ```

4. 运行`playbook`

   ```shell
   [root@ansible playbooks]# tree
   .
   ├── ansible.cfg
   ├── files
   │   └── nginx.conf
   ├── hosts
   ├── README.md
   ├── template
   │   └── index.html.j2
   └── web-notls.yml
   
   [root@ansible playbooks]# ansible-playbook web-notls.yml
   
   # 如果playbook文件权限设置为可执行，并且首行如下
   #!/usr/bin/env ansible-playbook
   # 那么就可以通过直接调用它自己来执行，如下所示
   ./web-notls.yml
   ```

二、`YAML`格式的`playbook`