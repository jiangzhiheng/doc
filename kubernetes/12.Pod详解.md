一、静态`Pod`

1. 特点：

   - 静态`Pod`是由`kubelet`进行管理的近存在于特定`Node`上的`Pod`。
   - 它们不能通过`API Server`进行管理，无法与`ReplicationController,Deployment`或者`DaemonSet`进行关联，并且`kubelet`无法对它们进行健康状态检查。
   - 静态`Pod`总是由`Kubelet`创建的，并且总在`kubelet`所在的`Node`上运行

2. 静态`Pod`创建方式

   1. 配置文件方式

      - 需要设置`kubelet`的启动参数`--pod-manifest-path`(或者在`kubelet`配置文件`/etc/sysconfig/kubelet`中添加`staticPodPath`(新版本推荐方式))指定`kubelet`需要监控的配置文件所在的目录。

      - `kubelet`会定期扫描该目录，并根据该目录下的`.yaml 或者 .json`文件进行创建操作

      - 创建示例

        ```yaml
        # 假定配置目录为/etc/kubelet.d/
        # vim /etc/kubelet.d/static-pod-demo.yaml
        apiVersion: v1
        kind: Pod
        metadata:
          name: static-web
          labels:
            name: static-web
        spec:
          containers:
          - name: static-web
            image: nginx
            ports:
            - name: http
              containerPort: 80
              
        # 保存退出后，pod会被自动创建到该节点上，由于无法被API Server管理，所以无法进行删除操作，只能将 /etc/kubelet.d/下的定义文件删除     
        ```

   2. `HTTP`方式

      - 通过设置`kubelet`启动参数`--manifest-url`，`kubelet`将会定期从该`URL`地址下载`Pod`的定义文件，并解析后创建`Pod`，实现方式与配置文件方式一致。

二、在容器内获取`Pod`信息(`Downward API`)

1. `Downward API`可以通过以下两种方式将`Pod`信息注入容器内部

   - 环境变量：用于单个变量，可以将`Pod`信息和`Container`信息注入容器内部
   - `Volume`挂载：将数组类信息生成为文件并挂载到容器内部

2. 环境变量方式：将`Pod`信息注入为环境变量

   - 字段引用

     `kubectl explain pods.spec.containers.env.valueFrom`

     - `valueFrom <Object>`
       - `fieldRef <Object>`：`Selects a field of the pod: supports metadata.name, metadata.namespace,metadata.labels, metadata.annotations, spec.nodeName,spec.serviceAccountName, status.hostIP, status.podIP, status.podIPs.`
         - `apiVersion	<string>`
         - `fieldPath	<string> -required-`

   - 示例

     ```yaml
     apiVersion: v1
     kind: Pod
     metadata:
       name: dapi-test-pod
     spec:
       containers:
       - name: test-container
         image: busybox:latest
         imagePullPolicy: IfNotPresent
         command: ["/bin/sh","-c","env"]
         env:
         - name: MY_POD_NAME
           valueFrom:
             fieldRef:
               fieldPath: metadata.name
         - name: MY_POD_NAMESPACE
           valueFrom:
             fieldRef:
               fieldPath: metadata.namespace
         - name: MY_POD_IP
           valueFrom:
             fieldRef:
               fieldPath: status.podIP
       restartPolicy: Never
     ```

     测试：

     ```shell
     kubectl create -f dapi-test-pod.yaml
     kubectl logs dapi-test-pod
     MY_POD_NAME=dapi-test-pod
     MY_POD_IP=10.244.2.18
     MY_POD_NAMESPACE=default
     # 可以看到，Pod的IP，namespace，name等信息都被正确保存到了Pod的环境变量中
     ```

3. 环境变量方式：将容器资源信息注入为环境变量

   

4. `Volume`挂载方式

