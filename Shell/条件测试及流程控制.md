1. ### **Shell条件测试**

   1. 概述

      - 格式1：test 条件表达式

      - 格式2：[ 条件表达式 ]

      ```shell
      #!/bin/bash
      #
      back_dir=/var/mysql_back
      #if ! test -d $back_dir;then
      if [ ! -d $back_dir ];then
              mkdir -p $back_dir
      fi
      
      echo "Start Backup..."
      ```

      ```shell
      #!/bin/bash
      #
      #if [ $UID -ne 0 ];then
      if [ $USER != "root" ];then
              echo "Permission deny!"
              exit
      fi
      
      echo "Start install..."
      
      ```

      - 格式3：[[ 条件表达式 ]]

   2. 文件测试

      [ -e dir/file ]     判断是否存在

      [ -d dir ]

      [ -f file ]   是否存在，而且是文件

      [ -r file ]  当前用户对该文件是否具有读权限

      [ -x file ]

      [ -w file ]

      [ -L file ]   判断是否为链接文件

      [ -b /dev/sda ]  判断是否为块设备

      [ -c /dev/sda ]  判断是否为字符设备

   3. 数值比较

      -gt   大于

      -ge   大于等于

      -lt   小于

      -le   小于等于

      -eq   等于

      -ne   不等于

      ```shell
      #!/bin/bash
      #
      read -p "Please input a username: " user
      
      if id $user &>/dev/null;then
              echo "user $user already exists"
      else
              /usr/sbin/useradd $user
              if [ $? -eq 0 ];then
                      echo "$user is created"
              fi
      fi
      
      ```

      磁盘使用率告警脚本

      ```shell
      #!/bin/bash
      #判断磁盘使用率，如果使用率大于90%则发邮件给对应用户
      #配置crontab每5分钟执行一次  * /5 * * * 
      disk_use=`df -Th | grep '/$'|awk '{print $(NF-1)}' |awk -F"%" '{print $1}'`
      mail_user=root
      if [ $disk_use -ge 90 ];then
              echo "`date +%F-%H` disk: ${disk_use}%" |mail -s "disk warning.." $mail_user
      fi
      
      ```

      

   4. 

2. 